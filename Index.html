<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="utf-8">
    <title>Light in the dark</title>
    <!--
        <link rel="stylesheet" href="css/styles.css">
    -->
</head>
<body>
    <div id="gameDiv"></div>

    <script src="js/pixi.min.js"></script>
    <script src="js/matter.min.js"></script>
 <!--
    <script type="text/javascript" src="start.js"></script>
    <script type="text/javascript" src="HealthAndLight.js"></script>
    <script type="text/javascript" src="AvatarMovement.js"></script>
-->
    <script>
        let app;
        let bgBack;
        let bgBackTree;
        let bgMiddleTree;
        let bgFront;
        let bgX = 0;
        let bgSpeed = 1;


        window.onload = function () {
            app = new PIXI.Application({
                width: 1200,
                height: 900,
                backgroundColor: 0xAAAAAA
            });

            document.querySelector("#gameDiv").appendChild(app.view);

            app.loader.baseUrl = "images/assets/background";
            app.loader
                .add("bgBack", "background_1960x1080.png")
                .add("bgBackTree", "trees_bg_1960x1080.png")
                .add("bgMiddleTree", "trees_fg_1960x1080.png")
                .add("bgFront", "front_1960x1080.png");
            
            app.loader.onComplete.add(initLevel);
            app.loader.load();

            
        }

        function gameLoop(delta) {
            updateBg();
        }

        function initLevel() {
            bgBack = createBg(app.loader.resources["bgBack"].texture);
            bgBackTree = createBg(app.loader.resources["bgBackTree"].texture);
            bgMiddleTree = createBg(app.loader.resources["bgMiddleTree"].texture);
            bgFront = createBg(app.loader.resources["bgFront"].texture);
            
            document.addEventListener("keyup", switchDir);

            app.ticker.add(gameLoop);
        }

        // Texturen werden geladen
        function createBg(texture) {
            let tiling = new PIXI.TilingSprite(texture, 1200, 900);
            tiling.position.set(0,0);
            app.stage.addChild(tiling);

            return tiling;
        }

        // Schnelligkeit der Hintergrundbilder
        function updateBg() {
            bgX = (bgX + bgSpeed);
            bgMiddleTree.tilePosition.x = bgX;
            bgBackTree.tilePosition.x = bgX / 2;
            bgBack.tilePosition.x = bgX / 4;
        }


        // Schnelligkeit wird verändert, wenn man die Pfeiltasten vor oder zurück drückt.
        // Spacebar stoppt scrolling
        function switchDir(e) {
            switch (e.keyCode) {
                // linke Pfeiltaste
                case 37:
                    bgSpeed = bgSpeed +1;
                    break;
                // rechte Pfeiltaste
                case 39:
                    bgSpeed = bgSpeed -1;
                    break;
                // Spacebar
                case 32:
                    bgSpeed = 0;
                    break;
            }
        }


    </script>


</body>
</html>
